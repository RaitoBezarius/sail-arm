# Snapshot of Isabelle definitions of Armv9.4-A

This directory contains snapshots of the Isabelle theories generated by Sail
for the ARM v9.4 specification.  This snapshots is provided for convenience,
and is not guaranteed to be up-to-date.

The snapshot was generated from model revision `f7e11ae` using Lem revision
`03739ab` and Sail version 0.17.1, with some manual patches to split the
specification up into smaller files and tweak some definitions, e.g. adding
termination measures for loops.

It requires [Isabelle 2022](https://isabelle.in.tum.de/website-Isabelle2022/index.html)
to build, as well as the `Word_Lib` entry in the [Archive of Formal
Proofs](https://www.isa-afp.org/).  The 2022 version of the latter can be
downloaded [here](https://foss.heptapod.net/isa-afp/afp-2022).

Building the model also requires a lot of memory, so it might be necessary to
increase the maximum heap size for Isabelle, e.g. by adding the following lines
to the `etc/settings` file in the Isabelle user home directory (in
`~/.isabelle/Isabelle2022` by default under Linux), as recommended for
"ambitious applications" in Section 2.6 of the Isabelle System Manual:

```
ISABELLE_TOOL_JAVA_OPTIONS="-Xms4g -Xmx32g -Xss16m"
ML_OPTIONS="--minheap 4G --maxheap 16G"
```

A heap image containing the architecture definitions (as well as the Lem and
Sail libraries in the [lib](lib/) subdirectory) can be built using

```
isabelle build -b -d $WORD_LIB -d . Sail-Armv9
```

where `$WORD_LIB` is the path to the `thys/Word_Lib` subdirectory of the AFP.

This takes roughly 5 hours on an Intel Core i7-1260P with 64GB RAM.

An interactive session based on this heap image can be started using the
following command:

```
isabelle jedit -d $WORD_LIB -d . -l Sail-Armv9
```

See the [Sail](https://github.com/rems-project/sail),
[Lem](https://github.com/rems-project/lem), and
[Isabelle](https://isabelle.in.tum.de/) websites for more information on those
projects.
